<h4>{{ 'customer.addresses.title' | t }}</h4>
<div class="vc-product-address">
    <ul class="list">
        <li ng-repeat="address in $ctrl.addresses" ng-init="addrCopy = $ctrl.clone(address)" ng-class="{ 'list-item': !addrCopy.editMode }">
            <a ng-click="$ctrl.delete($index)" ng-if="!addrCopy.editMode">{{ 'customer.addresses.delete' | t }}</a>
            <span class="form-spacer"></span>
            <a ng-click="addrCopy.editMode=true" ng-if="!addrCopy.editMode">{{ 'customer.addresses.edit' | t }}</a>
            <span class="form-spacer"></span>
            <h3 ng-if="addrCopy.editMode">{{ 'customer.addresses.edit_old' | t }}</h3>
            <vc-address address="addrCopy" edit-mode="addrCopy.editMode" validation-container="$ctrl" countries="$ctrl.accountManager.availCountries" get-country-regions="$ctrl.accountManager.getCountryRegions(country)" ng-click="addrCopy.editMode ? null : addrCopy.editMode=true"></vc-address>
            <div ng-if="addrCopy.editMode" class="form-actions">
                <!--<p>
                        {{ form.set_as_default_checkbox }}
                        <label for="address_default_address_new" class="inline">{{ 'customer.addresses.set_default' | t }}</label>
                    </p>-->
                <button ng-click="$ctrl.cancel($index, addrCopy)" ng-disabled="loader.isLoading" class="vc-btn" ng-class="{ 'btn--disabled': detailForm.$pristine, 'loading': loader.isLoading }">
                    <span class="btn-text">{{ 'customer.addresses.cancel' | t }}</span>
                    <span class="btn-loading"></span>
                </button>
                <span class="form-spacer"></span>
                <button ng-click="$ctrl.submit($index, addrCopy)" ng-disabled="loader.isLoading" class="vc-btn" ng-class="{ 'btn--disabled': detailForm.$pristine, 'loading': loader.isLoading }">
                    <span class="btn-text">{{ 'customer.addresses.update' | t }}</span>
                    <span class="btn-loading"></span>
                </button>
            </div>
        </li>
    </ul>

    <p ng-if="!$ctrl.addresses || !$ctrl.addresses.length">{{ 'customer.addresses.no_addresses_message' | t }}</p>

    <button ng-click="$ctrl.newAddress={}" ng-if="!$ctrl.newAddress" class="vc-btn">{{ 'customer.addresses.add_new' | t }}</button>
    <h2 ng-if="$ctrl.newAddress">{{ 'customer.addresses.add_new' | t }}</h2>
    <vc-address address="$ctrl.newAddress" edit-mode="true" validation-container="$ctrl" countries="$ctrl.accountManager.availCountries" get-country-regions="$ctrl.accountManager.getCountryRegions(country)" ng-if="$ctrl.newAddress"></vc-address>
    <div ng-if="$ctrl.newAddress">
        <button ng-click="$ctrl.newAddress = null" class="vc-btn" ng-class="{ 'loading': loader.isLoading }">
            <span class="btn-text">{{ 'customer.addresses.cancel' | t }}</span>
            <span class="btn-loading"></span>
        </button>
        <span class="form-spacer"></span>
        <button ng-click="$ctrl.addNewAddress()" ng-disabled="loader.isLoading" class="vc-btn" ng-class="{ 'btn--disabled': detailForm.$pristine, 'loading': loader.isLoading }">
            <span class="btn-text">{{ 'customer.addresses.add' | t }}</span>
            <span class="btn-loading"></span>
        </button>
    </div>
</div>